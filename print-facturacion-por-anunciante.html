
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>PRINT - Facturaci√≥n por Anunciante</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
/* --- Tus estilos originales --- */
:root{
  --card:#111827;
  --text:#e5e7eb;
  --base:#38bdf8;      /* azul */
  --comp:#f59e0b;      /* amarillo */
  --neg:#f87171;       /* rojo */
  --diffColor:#6ee7b7; /* verde claro */
  --ok-green:#34d399;  
  --totalBg:#1e40af;
  --fucsia: #db2777;   /* Color fucsia para PRINT */

  --revistaBg:#fef3c7; 
  --productoBg:#dbeafe; 
  --sectorBg:#fbcfe8;
  --comercialBg:#d1fae5; 
  --areaBg:#fcd5ce; 
  --anuncianteBg:#e9d5ff;

  --title-mes:var(--comp);
  --title-revista:var(--comp);
  --title-producto:var(--comp);
  --title-comercial:var(--comp);

  --bullet-size: 1.1rem;
  --bullet-indent: 22px;
  --summary-bg:#111827;
  --summary-border:#4b5563;
  --base-color: #f59e0b;
}
/* ... resto de tus estilos ... */
</style>
</head>

<body>

<nav class="nav-menu">
    <span style="color: var(--base-color); font-weight: bold; margin-right: 10px; opacity: 1;">DIGITAL:</span>
    <a href="digital-datos-graficos.html">Datos</a>
    <a href="digital-facturacion-desglosada.html">Desglose</a>
    <a href="digital-facturacion-por-anunciante.html">Anunciantes</a>
    <a href="digital-facturacion-por-anunciante-y-marca.html">Marcas</a>
    <a href="digital-totales-familas-productos.html">Productos</a>

    <span style="color: var(--fucsia); font-weight: bold; margin-left: 20px; margin-right: 10px; border-left: 1px solid #4b5563; padding-left: 20px; opacity: 1;">PRINT:</span>
    <a href="print-datos-graficos.html">Datos</a>
    <a href="print-facturacion-desglosada.html">Desglose</a>
    <a href="print-facturacion-por-anunciante.html" class="active">Anunciantes</a>
    <a href="print-facturacion-por-anunciante-y-marca.html">Marcas</a>
    
    <a href="index.html" style="margin-left: 20px; border-left: 1px solid #4b5563; padding-left: 20px;">üè† Home</a>
</nav>

<h1>PRINT - Facturaci√≥n por Anunciante</h1>

<div class="container">
  <div class="card">
    <label class="upload-label">Cargar datos (Excel):</label>
    <div class="file-input-wrapper">
        <input type="file" id="fileInput" accept=".json,.xlsx">
    </div>
    <div id="loadStatus">Esperando archivo...</div>
  </div>

  <!-- ... resto de tu HTML original ... -->
</div>

<!-- ======= BLOQUE A√ëADIDO: Auto-carga del Excel (PRODUCCION PRINT.xlsx) ======= -->
<script>
// Opci√≥n A: Excel en la misma carpeta que este HTML
const excelUrl = "PRODUCCION%20PRINT.xlsx";

// Opci√≥n B: Excel en GitHub Raw (descomenta y pega tu URL cruda si lo prefieres)
// const excelUrl = "https://raw.githubusercontent.com/USUARIO/REPO/BRANCH/ruta/PRODUCCION%20PRINT.xlsx";

window.addEventListener("DOMContentLoaded", () => {
  const statusEl = document.getElementById("loadStatus");
  if (statusEl) statusEl.innerText = "Cargando archivo PRODUCCION PRINT.xlsx‚Ä¶";

  fetch(excelUrl)
    .then(resp => {
      if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
      return resp.arrayBuffer();
    })
    .then(buf => {
      const wb = XLSX.read(buf, { type: "array" });
      const ws = wb.Sheets[wb.SheetNames[0]];
      const json = XLSX.utils.sheet_to_json(ws, { defval: "" });
      // Reutilizamos tu flujo original:
      init(json);
      if (statusEl) {
        statusEl.innerText = "‚úÖ Archivo cargado autom√°ticamente";
        statusEl.style.color = "var(--ok-green)";
      }
      // (Opcional) Desactivar input manual:
      // const fi = document.getElementById("fileInput"); if (fi) fi.disabled = true;
    })
    .catch(err => {
      console.error("Auto-carga fallida:", err);
      if (statusEl) {
        statusEl.innerText = "‚ö†Ô∏è No se pudo cargar autom√°ticamente. Selecciona el Excel manualmente.";
        statusEl.style.color = "var(--neg)";
      }
    });
});
</script>
<!-- ======= FIN BLOQUE A√ëADIDO ======= -->

<script>
/* --- Tu script original completo aqu√≠ --- */
const MONTHS = ["01 Enero","02 Febrero","03 Marzo","04 Abril","05 Mayo","06 Junio","07 Julio","08 Agosto","09 Septiembre","10 Octubre","11 Noviembre","12 Diciembre"];
const MONTH_NAMES = MONTHS.map(m => m.slice(3));
let rawData = [];

/* ... resto de tu JS original sin cambios ... */
</script>
</body>
</html>
